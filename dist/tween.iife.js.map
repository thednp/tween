{"version":3,"file":"tween.iife.js","sources":["../src/Now.ts","../src/Runtime.ts","../src/Tween.ts","../src/Timeline.ts","../src/Easing.ts","../src/interpolators/array.ts","../src/interpolators/path.ts"],"sourcesContent":["let _nowFunc = () => performance.now();\n\nexport const now = (): number => {\n  return _nowFunc();\n};\n\nexport function setNow(nowFunction: typeof _nowFunc) {\n  _nowFunc = nowFunction;\n}\n","// Runtime.ts\nimport { type Tween } from \"./Tween.ts\";\nimport { type Timeline } from \"./Timeline.ts\";\nimport { now } from \"./Now.ts\";\nimport { TweenProps } from \"./types.ts\";\n\ntype AnimationItem<T extends TweenProps = never> = Tween<T> | Timeline<T>;\n\nexport const Queue: AnimationItem[] = [];\n\nexport function addToQueue<T extends TweenProps>(\n  newItem: AnimationItem<T>,\n): void {\n  const item = newItem as unknown as AnimationItem<never>;\n  if (Queue.includes(item)) return;\n  Queue.push(item);\n  if (!rafID) Runtime();\n}\n\nexport function removeFromQueue<T extends TweenProps>(\n  removedItem: AnimationItem<T>,\n): void {\n  Queue.splice(\n    Queue.indexOf(removedItem as unknown as AnimationItem<never>),\n    1,\n  );\n}\n\nlet rafID = 0;\n\nexport function Runtime(t = now()) {\n  let i = 0;\n  while (i < Queue.length) {\n    if (Queue[i].update(t)) {\n      i += 1;\n    } else {\n      Queue.splice(i, 1);\n    }\n  }\n\n  if (Queue.length === 0) {\n    cancelAnimationFrame(rafID);\n    rafID = 0;\n  } else rafID = requestAnimationFrame(Runtime);\n}\n","// Tween.ts\nimport type {\n  BaseTweenProps,\n  DeepPartial,\n  EasingFunction,\n  InterpolatorFunction,\n  TweenCallback,\n  TweenProps,\n  TweenUpdateCallback,\n} from \"./types.ts\";\nimport { addToQueue, removeFromQueue } from \"./Runtime.ts\";\nimport { now } from \"./Now.ts\";\n\nexport class Tween<T extends TweenProps = never> {\n  private _interpolators = new Map<string, InterpolatorFunction>();\n  private _state: T;\n  private _startIsSet = false;\n  private _startFired = false;\n  private _propsStart: TweenProps = {};\n  private _propsEnd: TweenProps = {};\n  private _isPlaying = false;\n  private _duration = 1000;\n  private _delay = 0;\n  private _easing: EasingFunction = (t) => t;\n  private _startTime: number = 0;\n  private _onUpdate?: TweenUpdateCallback<T>;\n  private _onComplete?: TweenCallback<T>;\n  private _onStart?: TweenCallback<T>;\n  private _onStop?: TweenCallback<T>;\n\n  constructor(initialValues: T) {\n    this._state = initialValues;\n    return this;\n  }\n\n  get isPlaying(): boolean {\n    return this._isPlaying;\n  }\n\n  start(time = now(), overrideStart = false) {\n    if (this._isPlaying) return this;\n    // istanbul ignore else @preserve\n    if (!this._startIsSet || /* istanbul ignore next */ overrideStart) {\n      this._startIsSet = true;\n\n      this._setProps(\n        this._state,\n        this._propsStart,\n        this._propsEnd,\n        overrideStart,\n      );\n    }\n    this._isPlaying = true;\n    this._startTime = time;\n    this._startTime += this._delay;\n    addToQueue(this);\n    return this;\n  }\n  startFromLast(time = now()) {\n    return this.start(time, true);\n  }\n  stop() {\n    if (!this._isPlaying) return this;\n    removeFromQueue(this);\n    this._isPlaying = false;\n    this._onStop?.(this._state);\n    return this;\n  }\n  from(startValues: Partial<T>) {\n    // this._propsStart = startValues as T;\n    Object.assign(this._propsStart, startValues);\n    this._startIsSet = false;\n\n    return this;\n  }\n  to(endValues: DeepPartial<T>) {\n    this._propsEnd = endValues as TweenProps;\n    this._startIsSet = false;\n\n    return this;\n  }\n  duration(seconds = 1) {\n    this._duration = seconds * 1000;\n    return this;\n  }\n  delay(seconds = 0) {\n    this._delay = seconds * 1000;\n    return this;\n  }\n\n  easing(easing: EasingFunction = (t: number) => t) {\n    this._easing = easing;\n    return this;\n  }\n  getDuration() {\n    return this._duration;\n  }\n  /**\n   * @param time - The current time\n   * @param autoStart - When true, calling update will implicitly call start()\n   * as well. Note, if you stop() or end() the tween, but are still calling\n   * update(), it will start again!\n   *\n   * @returns true if the tween is still playing after the update, false\n   * otherwise (calling update on a paused tween still returns true because\n   * it is still playing, just paused).\n   */\n  update(time = now(), autoStart?: boolean) {\n    // istanbul ignore else\n    if (!this._isPlaying) {\n      // istanbul ignore else\n      if (autoStart) this.start(time, true);\n      else return false;\n    }\n\n    // istanbul ignore else\n    if (time < this._startTime) return true;\n\n    // istanbul ignore else\n    if (!this._startFired && this._onStart) {\n      this._onStart(this._state);\n      this._startFired = true;\n    }\n\n    let elapsed = (time - this._startTime) / this._duration;\n    elapsed = this._duration === 0 || elapsed > 1 ? 1 : elapsed;\n    const progress = this._easing(elapsed);\n\n    this._setState(\n      this._state,\n      this._propsStart,\n      this._propsEnd,\n      progress,\n    );\n\n    this._onUpdate?.(this._state, elapsed, progress);\n\n    // istanbul ignore else\n    if (elapsed === 1) {\n      this._onComplete?.(this._state);\n      this._isPlaying = false;\n\n      return false;\n    }\n    return true;\n  }\n\n  onStart(callback: TweenCallback<T>) {\n    this._onStart = callback;\n    return this;\n  }\n  onUpdate(callback?: TweenUpdateCallback<T>) {\n    this._onUpdate = callback;\n    return this;\n  }\n  onComplete(callback: TweenCallback<T>) {\n    this._onComplete = callback;\n    return this;\n  }\n  onStop(callback: TweenCallback<T>) {\n    this._onStop = callback;\n    return this;\n  }\n\n  private _setState(\n    object: TweenProps | BaseTweenProps,\n    valuesStart: TweenProps | BaseTweenProps,\n    valuesEnd: Partial<T> | TweenProps | BaseTweenProps,\n    value: number,\n  ): void {\n    const endEntries = Object.entries(valuesEnd);\n    const len = endEntries.length;\n\n    let i = 0;\n    while (i < len) {\n      const [property, end] = endEntries[i];\n      i++;\n      // Don't update properties that do not exist in the source object\n      // istanbul ignore else\n      if (valuesStart[property] === undefined) continue;\n\n      const start = valuesStart[property];\n\n      // Protect against non matching properties.\n      // istanbul ignore else @preserve\n      if (start.constructor !== end?.constructor) continue;\n\n      // Protect against non numeric properties.\n      // istanbul ignore else @preserve\n      if (this._interpolators.has(property)) {\n        const interpolator = this._interpolators.get(property)!;\n        object[property] = interpolator(start as never, end as never, value);\n      } else if (typeof end === \"number\") {\n        object[property] = (start as number) +\n          (end - (start as number)) * value;\n      } else if (typeof end === \"object\") {\n        this._setState(\n          object[property] as BaseTweenProps,\n          start as BaseTweenProps,\n          end as BaseTweenProps,\n          value,\n        );\n      }\n    }\n  }\n  private _setProps(\n    obj: T,\n    propsStart: TweenProps,\n    propsEnd: TweenProps,\n    overrideStartingValues: boolean,\n  ): void {\n    const endKeys = Object.keys(propsEnd);\n\n    for (const property of endKeys) {\n      const startValue = obj[property];\n\n      // Save the starting value, but only once unless override is requested.\n      // istanbul ignore else\n      if (\n        typeof propsStart[property] === \"undefined\" ||\n        overrideStartingValues\n      ) {\n        propsStart[property] = startValue;\n      }\n    }\n  }\n  use(\n    property: string,\n    interpolateFn: InterpolatorFunction,\n  ): this {\n    // istanbul ignore else\n    if (!this._interpolators.has(property)) {\n      this._interpolators.set(property, interpolateFn);\n    }\n    return this;\n  }\n}\n","// Timeline.ts\nimport type {\n  BaseTweenProps,\n  DeepPartial,\n  InterpolatorFunction,\n  Position,\n  TimelineCallback,\n  TimelineEntry,\n  TimelineEntryConfig,\n  TweenProps,\n} from \"./types.ts\";\nimport { addToQueue, removeFromQueue } from \"./Runtime.ts\";\nimport { now } from \"./Now.ts\";\n\nexport class Timeline<T extends TweenProps = never> {\n  public state: T;\n  private _state: T;\n  private _entries: TimelineEntry<T>[] = [];\n  private _labels = new Map<string, number>();\n  private _progress = 0;\n  private _duration = 0;\n  private _time = 0;\n  private _pauseTime = 0;\n  private _lastTime?: number;\n  private _isPlaying = false;\n  private _repeat = 0;\n  private _initialRepeat = 0;\n  private _interpolators = new Map<string, InterpolatorFunction>();\n  private _onStart?: TimelineCallback<T>;\n  private _onStop?: TimelineCallback<T>;\n  private _onPause?: TimelineCallback<T>;\n  private _onResume?: TimelineCallback<T>;\n  private _onUpdate?: TimelineCallback<T>;\n  private _onComplete?: TimelineCallback<T>;\n\n  constructor(initialState: T) {\n    this.state = initialState;\n    this._state = { ...initialState };\n  }\n\n  to(\n    {\n      duration = 1,\n      easing = (t) => t,\n      ...values\n    }: DeepPartial<T> & TimelineEntryConfig,\n    position: Position = \"+=0\",\n  ): this {\n    const startTime = this._resolvePosition(position);\n    const to = values as TweenProps & DeepPartial<T>;\n    const entryDuration = duration * 1000;\n\n    this._entries.push({\n      to,\n      startTime,\n      duration: entryDuration,\n      easing,\n      hasStarted: false,\n    });\n\n    const endTime = startTime + entryDuration;\n    this._duration = Math.max(this._duration, endTime);\n\n    return this;\n  }\n\n  play(): this {\n    if (this._pauseTime) return this.resume();\n    if (this._isPlaying) return this;\n\n    this._isPlaying = true;\n    this._lastTime = undefined;\n    this._time = 0;\n    this._resetState();\n    this._updateEntries(0);\n    this._onStart?.(this.state, 0);\n\n    addToQueue(this);\n    return this;\n  }\n\n  pause(): this {\n    if (!this._isPlaying) return this;\n    this._isPlaying = false;\n    this._pauseTime = now();\n    this._onPause?.(this.state, this.progress);\n    return this;\n  }\n\n  resume(time = now()): this {\n    if (this._isPlaying) return this;\n    this._isPlaying = true;\n    const dif = time - this._pauseTime;\n    this._pauseTime = 0;\n    this._lastTime = (this._lastTime || time) + dif;\n    this._onResume?.(this.state, this.progress);\n\n    addToQueue(this);\n    return this;\n  }\n\n  stop(): this {\n    if (!this._isPlaying) return this;\n    this._isPlaying = false;\n    this._time = 0;\n    this._pauseTime = 0;\n    removeFromQueue(this);\n    this._resetState();\n    this._updateEntries(0);\n    this._onStop?.(this.state, this._progress);\n    return this;\n  }\n\n  repeat(count = 0): this {\n    this._repeat = count;\n    this._initialRepeat = count;\n    return this;\n  }\n\n  seek(pointer: number | string): this {\n    const elapsed = this._resolvePosition(pointer);\n    this._resetState();\n    this._time = Math.max(0, elapsed);\n    this._updateEntries(this._time);\n    return this;\n  }\n\n  label(name: string, position?: Position): this {\n    this._labels.set(name, this._resolvePosition(position));\n    return this;\n  }\n\n  onStart(cb: TimelineCallback<T>): this {\n    this._onStart = cb;\n    return this;\n  }\n\n  onPause(cb: TimelineCallback<T>): this {\n    this._onPause = cb;\n    return this;\n  }\n\n  onResume(cb: TimelineCallback<T>): this {\n    this._onResume = cb;\n    return this;\n  }\n\n  onStop(cb: TimelineCallback<T>): this {\n    this._onStop = cb;\n    return this;\n  }\n\n  onUpdate(cb: TimelineCallback<T>): this {\n    this._onUpdate = cb;\n    return this;\n  }\n\n  onComplete(cb: TimelineCallback<T>): this {\n    this._onComplete = cb;\n    return this;\n  }\n\n  get progress(): number {\n    return this._progress;\n  }\n\n  get duration(): number {\n    return this._duration;\n  }\n\n  get isPlaying(): boolean {\n    return this._isPlaying;\n  }\n\n  get isPaused(): boolean {\n    return !this._isPlaying && this._pauseTime > 0;\n  }\n\n  update(time = now()) {\n    if (!this._isPlaying) return false;\n    if (this._lastTime === undefined) this._lastTime = time;\n    const delta = time - this._lastTime;\n    this._lastTime = time;\n    this._time += delta;\n\n    this._updateEntries(this._time);\n\n    // istanbul ignore else\n    if (this._progress === 1) {\n      // istanbul ignore else\n      if (this._repeat === 0) {\n        this._isPlaying = false;\n        this._repeat = this._initialRepeat;\n\n        this._onComplete?.(this.state, 1);\n      } else {\n        // istanbul ignore else @preserve\n        if (this._repeat !== Infinity) this._repeat--;\n        this._time = 0;\n        this._resetState();\n        this._updateEntries(0);\n      }\n    }\n    return this._isPlaying;\n  }\n\n  private _updateEntries(elapsed: number) {\n    this._progress = this._duration === 0 || elapsed >= this._duration\n      ? 1\n      : elapsed / this._duration;\n\n    let i = 0;\n    const entriesLen = this._entries.length;\n    while (i < entriesLen) {\n      const entry = this._entries[i];\n      const localTime = elapsed - entry.startTime;\n      const tweenElapsed = Math.max(0, Math.min(1, localTime / entry.duration));\n\n      if (!entry.hasStarted && tweenElapsed > 0) {\n        entry.hasStarted = true;\n        entry.startValues = {};\n        for (const key in entry.to) {\n          entry.startValues[key] = this.state[key];\n        }\n      }\n\n      if (entry.hasStarted) {\n        this._setState(\n          this.state,\n          entry.startValues as TweenProps & DeepPartial<T>,\n          entry.to as TweenProps & DeepPartial<T>,\n          entry.easing(tweenElapsed),\n        );\n      }\n      i += 1;\n    }\n\n    this._onUpdate?.(this.state, this._progress);\n  }\n\n  private _resolvePosition(pos?: Position): number {\n    if (typeof pos === \"number\") return pos * 1000;\n\n    // istanbul ignore else @preserve\n    if (typeof pos === \"string\") {\n      // First try label\n      const labelTime = this._labels.get(pos);\n      if (labelTime !== undefined) return labelTime;\n\n      // Then relative\n      // istanbul ignore else @preserve\n      if (pos.startsWith(\"+=\") || pos.startsWith(\"-=\")) {\n        let offset = parseFloat(pos.slice(2));\n        if (isNaN(offset)) offset = 0;\n        offset *= 1000;\n        return pos.startsWith(\"+=\")\n          ? this._duration + offset\n          : Math.max(0, this._duration - offset);\n      }\n    }\n\n    // fallback to current duration\n    return this._duration;\n  }\n\n  private _setState(\n    object: TweenProps | BaseTweenProps,\n    valuesStart: TweenProps | BaseTweenProps,\n    valuesEnd: Partial<T> | TweenProps | BaseTweenProps,\n    value: number,\n  ): void {\n    const endEntries = Object.entries(valuesEnd);\n    const len = endEntries.length;\n    let i = 0;\n\n    while (i < len) {\n      const [property, end] = endEntries[i];\n      i++;\n      if (valuesStart[property] === undefined) continue;\n\n      const start = valuesStart[property];\n\n      if (start.constructor !== end?.constructor) continue;\n\n      // istanbul ignore else @preserve\n      if (this._interpolators.has(property)) {\n        const interpolator = this._interpolators.get(property)!;\n        object[property] = interpolator(start as never, end as never, value);\n      } else if (typeof end === \"number\") {\n        object[property] = (start as number) +\n          (end - (start as number)) * value;\n      } else if (typeof end === \"object\") {\n        this._setState(\n          object[property] as BaseTweenProps,\n          start as BaseTweenProps,\n          end as BaseTweenProps,\n          value,\n        );\n      }\n    }\n  }\n\n  private _resetState() {\n    Object.assign(this.state, this._state);\n    let i = 0;\n    const entriesLen = this._entries.length;\n    while (i < entriesLen) {\n      const entry = this._entries[i];\n      entry.hasStarted = false;\n      entry.startValues = undefined;\n      i += 1;\n    }\n  }\n\n  clear() {\n    this._entries.length = 0;\n    this._duration = 0;\n    this._labels.clear();\n    this._time = 0;\n    this._progress = 0;\n    this._pauseTime = 0;\n    this._lastTime = undefined;\n    // Optionally reset repeat if you want fresh repeats on remount\n    this._repeat = this._initialRepeat;\n    return this;\n  }\n\n  use(\n    property: string,\n    interpolateFn: InterpolatorFunction,\n  ): this {\n    if (!this._interpolators.has(property)) {\n      this._interpolators.set(property, interpolateFn);\n    }\n    return this;\n  }\n}\n","// Easing.ts\nimport type { EasingFunction, EasingFunctionGroup } from \"./types.ts\";\n\n/**\n * The Ease class provides a collection of easing functions for use with tween.js.\n */\n\nexport const Easing = Object.freeze({\n  Linear: Object.freeze<EasingFunctionGroup & { None: EasingFunction }>({\n    None(amount: number): number {\n      return amount;\n    },\n    In(amount: number): number {\n      return amount;\n    },\n    Out(amount: number): number {\n      return amount;\n    },\n    InOut(amount: number): number {\n      return amount;\n    },\n  }),\n\n  Quadratic: Object.freeze(\n    <EasingFunctionGroup> {\n      In(amount: number): number {\n        return amount * amount;\n      },\n      Out(amount: number): number {\n        return amount * (2 - amount);\n      },\n      InOut(amount: number): number {\n        if ((amount *= 2) < 1) {\n          return 0.5 * amount * amount;\n        }\n\n        return -0.5 * (--amount * (amount - 2) - 1);\n      },\n    },\n  ),\n\n  Cubic: Object.freeze(\n    <EasingFunctionGroup> {\n      In(amount: number): number {\n        return amount * amount * amount;\n      },\n      Out(amount: number): number {\n        return --amount * amount * amount + 1;\n      },\n      InOut(amount: number): number {\n        if ((amount *= 2) < 1) {\n          return 0.5 * amount * amount * amount;\n        }\n        return 0.5 * ((amount -= 2) * amount * amount + 2);\n      },\n    },\n  ),\n\n  Quartic: Object.freeze(\n    <EasingFunctionGroup> {\n      In(amount: number): number {\n        return amount * amount * amount * amount;\n      },\n      Out(amount: number): number {\n        return 1 - --amount * amount * amount * amount;\n      },\n      InOut(amount: number): number {\n        if ((amount *= 2) < 1) {\n          return 0.5 * amount * amount * amount * amount;\n        }\n\n        return -0.5 * ((amount -= 2) * amount * amount * amount - 2);\n      },\n    },\n  ),\n\n  Quintic: Object.freeze(\n    <EasingFunctionGroup> {\n      In(amount: number): number {\n        return amount * amount * amount * amount * amount;\n      },\n      Out(amount: number): number {\n        return --amount * amount * amount * amount * amount + 1;\n      },\n      InOut(amount: number): number {\n        if ((amount *= 2) < 1) {\n          return 0.5 * amount * amount * amount * amount * amount;\n        }\n\n        return 0.5 * ((amount -= 2) * amount * amount * amount * amount + 2);\n      },\n    },\n  ),\n\n  Sinusoidal: Object.freeze(\n    <EasingFunctionGroup> {\n      In(amount: number): number {\n        return 1 - Math.sin(((1.0 - amount) * Math.PI) / 2);\n      },\n      Out(amount: number): number {\n        return Math.sin((amount * Math.PI) / 2);\n      },\n      InOut(amount: number): number {\n        return 0.5 * (1 - Math.sin(Math.PI * (0.5 - amount)));\n      },\n    },\n  ),\n\n  Exponential: Object.freeze(\n    <EasingFunctionGroup> {\n      In(amount: number): number {\n        return amount === 0 ? 0 : Math.pow(1024, amount - 1);\n      },\n      Out(amount: number): number {\n        return amount === 1 ? 1 : 1 - Math.pow(2, -10 * amount);\n      },\n      InOut(amount: number): number {\n        if (amount === 0) {\n          return 0;\n        }\n\n        if (amount === 1) {\n          return 1;\n        }\n\n        if ((amount *= 2) < 1) {\n          return 0.5 * Math.pow(1024, amount - 1);\n        }\n\n        return 0.5 * (-Math.pow(2, -10 * (amount - 1)) + 2);\n      },\n    },\n  ),\n\n  Circular: Object.freeze(\n    <EasingFunctionGroup> {\n      In(amount: number): number {\n        return 1 - Math.sqrt(1 - amount * amount);\n      },\n      Out(amount: number): number {\n        return Math.sqrt(1 - --amount * amount);\n      },\n      InOut(amount: number): number {\n        if ((amount *= 2) < 1) {\n          return -0.5 * (Math.sqrt(1 - amount * amount) - 1);\n        }\n        return 0.5 * (Math.sqrt(1 - (amount -= 2) * amount) + 1);\n      },\n    },\n  ),\n\n  Elastic: Object.freeze(\n    <EasingFunctionGroup> {\n      In(amount: number): number {\n        if (amount === 0) {\n          return 0;\n        }\n\n        if (amount === 1) {\n          return 1;\n        }\n\n        return (\n          -Math.pow(2, 10 * (amount - 1)) *\n          Math.sin((amount - 1.1) * 5 * Math.PI)\n        );\n      },\n      Out(amount: number): number {\n        if (amount === 0) {\n          return 0;\n        }\n\n        if (amount === 1) {\n          return 1;\n        }\n        return (\n          Math.pow(2, -10 * amount) * Math.sin((amount - 0.1) * 5 * Math.PI) + 1\n        );\n      },\n      InOut(amount: number): number {\n        if (amount === 0) {\n          return 0;\n        }\n\n        if (amount === 1) {\n          return 1;\n        }\n\n        amount *= 2;\n\n        if (amount < 1) {\n          return (\n            -0.5 *\n            Math.pow(2, 10 * (amount - 1)) *\n            Math.sin((amount - 1.1) * 5 * Math.PI)\n          );\n        }\n\n        return (\n          0.5 *\n            Math.pow(2, -10 * (amount - 1)) *\n            Math.sin((amount - 1.1) * 5 * Math.PI) +\n          1\n        );\n      },\n    },\n  ),\n\n  Back: Object.freeze(\n    <EasingFunctionGroup> {\n      In(amount: number): number {\n        const s = 1.70158;\n        return amount === 1 ? 1 : amount * amount * ((s + 1) * amount - s);\n      },\n      Out(amount: number): number {\n        const s = 1.70158;\n        return amount === 0\n          ? 0\n          : --amount * amount * ((s + 1) * amount + s) + 1;\n      },\n      InOut(amount: number): number {\n        const s = 1.70158 * 1.525;\n        if ((amount *= 2) < 1) {\n          return 0.5 * (amount * amount * ((s + 1) * amount - s));\n        }\n        return 0.5 * ((amount -= 2) * amount * ((s + 1) * amount + s) + 2);\n      },\n    },\n  ),\n\n  Bounce: Object.freeze(\n    <EasingFunctionGroup> {\n      In(amount: number): number {\n        return 1 - Easing.Bounce.Out(1 - amount);\n      },\n      Out(amount: number): number {\n        if (amount < 1 / 2.75) {\n          return 7.5625 * amount * amount;\n        } else if (amount < 2 / 2.75) {\n          return 7.5625 * (amount -= 1.5 / 2.75) * amount + 0.75;\n        } else if (amount < 2.5 / 2.75) {\n          return 7.5625 * (amount -= 2.25 / 2.75) * amount + 0.9375;\n        } else {\n          return 7.5625 * (amount -= 2.625 / 2.75) * amount + 0.984375;\n        }\n      },\n      InOut(amount: number): number {\n        if (amount < 0.5) {\n          return Easing.Bounce.In(amount * 2) * 0.5;\n        }\n        return Easing.Bounce.Out(amount * 2 - 1) * 0.5 + 0.5;\n      },\n    },\n  ),\n\n  pow(power = 4): EasingFunctionGroup {\n    power = power < Number.EPSILON ? Number.EPSILON : power;\n    power = power > 10000 ? 10000 : power;\n    return {\n      In(amount: number): number {\n        return amount ** power;\n      },\n      Out(amount: number): number {\n        return 1 - (1 - amount) ** power;\n      },\n      InOut(amount: number): number {\n        if (amount < 0.5) {\n          return (amount * 2) ** power / 2;\n        }\n        return (1 - (2 - amount * 2) ** power) / 2 + 0.5;\n      },\n    };\n  },\n});\n","// interpolators/array.ts\nimport { InterpolatorFunction } from \"../types.ts\";\n\nexport const interpolateArray: InterpolatorFunction<number[]> = <\n  T extends number[],\n>(\n  start: T,\n  end: T,\n  value: number,\n) => {\n  if (value === 0 && start.length !== end.length) {\n    console.warn(\"Array length mismatch. Returning first array.\");\n    return start;\n  }\n  const result = [] as unknown as T;\n  const len = end.length;\n  let i = 0;\n\n  while (i < len) {\n    result.push(start[i] + (end[i] - start[i]) * value);\n    i += 1;\n  }\n  return result;\n};\n","// interpolators/path.ts\nimport type {\n  CubeValues,\n  InterpolatorFunction,\n  LineValues,\n  MorphPathArray,\n  MorphPathSegment,\n} from \"../types.ts\";\n\n/**\n * NOTE: Path interpolation only works when both paths have:\n * - Identical command structure (same number and order of M/L/C/Z)\n * - Corresponding coordinates to interpolate\n * Complex morphs (square â†’ triangle) require preprocessing (e.g. KUTE.JS, Flubber)\n * @param start - A starting PathArray value\n * @param end - A starting PathArray value\n * @param t - The progress\n * @returns The interpolated PathArray value\n */\n\nexport const interpolatePath: InterpolatorFunction<MorphPathArray> = <\n  T extends MorphPathArray,\n>(\n  start: T,\n  end: T,\n  t: number,\n): T => {\n  if (t === 0 && start.length !== end.length) {\n    console.warn(\"Path length mismatch. Returning start path.\");\n    return start;\n  }\n  const result = [] as unknown as T;\n\n  for (let i = 0; i < end.length; i += 1) {\n    const [pathCommand1, values1] = [\n      start[i][0],\n      start[i].slice(1) as LineValues | CubeValues,\n    ];\n    const [pathCommand2, values2] = [\n      end[i][0],\n      end[i].slice(1) as LineValues | CubeValues,\n    ];\n    const commandMismatch = pathCommand1 !== pathCommand2;\n\n    if (t === 0 && (values1.length !== values2.length || commandMismatch)) {\n      console.warn(\n        (commandMismatch ? \"PathCommand\" : \"Params\") +\n          \" mismatch at index: \" +\n          i +\n          \". Returning start path.\",\n      );\n      return start;\n    }\n\n    if (pathCommand1.toUpperCase() === \"Z\") {\n      result.push([\"Z\"]);\n    } else {\n      const resValues = [] as unknown as CubeValues | LineValues;\n\n      for (let j = 0; j < values2.length; j += 1) {\n        resValues.push(values1[j] + (values2[j] - values1[j]) * t);\n      }\n      result.push([pathCommand2, ...resValues] as MorphPathSegment);\n    }\n  }\n\n  return result;\n};\n"],"names":["_nowFunc","now","setNow","nowFunction","Queue","addToQueue","newItem","item","rafID","Runtime","removeFromQueue","removedItem","i","Tween","t","initialValues","time","overrideStart","startValues","endValues","seconds","easing","autoStart","elapsed","progress","callback","object","valuesStart","valuesEnd","value","endEntries","len","property","end","start","interpolator","obj","propsStart","propsEnd","overrideStartingValues","endKeys","startValue","interpolateFn","Timeline","initialState","duration","values","position","startTime","to","entryDuration","endTime","dif","count","pointer","name","cb","delta","entriesLen","entry","localTime","tweenElapsed","key","pos","labelTime","offset","Easing","amount","s","power","interpolateArray","result","interpolatePath","pathCommand1","values1","pathCommand2","values2","commandMismatch","resValues","j"],"mappings":"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"}