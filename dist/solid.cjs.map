{"version":3,"file":"solid.cjs","names":["Tween","Timeline"],"sources":["../src/solid/ministore.ts","../src/solid/index.ts"],"sourcesContent":["import { createSignal } from \"solid-js\";\nimport { type TweenProps } from \"@thednp/tween\";\n\nconst STATE_PROXY = \"_proxy\";\n\nconst isPlainObject = (\n  value: unknown,\n): value is Record<string, unknown> =>\n  typeof value === \"object\" &&\n  !Array.isArray(value) &&\n  Object.getPrototypeOf(value) === Object.prototype;\n\nfunction defineStateProxy<T extends Omit<TweenProps, \"_proxy\">>(\n  key: keyof T,\n  value: T[keyof T],\n  target: T,\n) {\n  const [get, set] = createSignal(value);\n  Object.defineProperties(target, {\n    [STATE_PROXY]: {\n      value: 1,\n      enumerable: false,\n      configurable: false,\n      writable: false,\n    },\n    [key]: { get, set, enumerable: true },\n  });\n}\n\nfunction createMiniState<T extends TweenProps>(\n  obj: T,\n  parentReceiver: TweenProps,\n) {\n  // istanbul ignore next @preserve\n  if (Object.prototype.hasOwnProperty.call(obj, STATE_PROXY)) return obj;\n  for (const [key, value] of Object.entries(obj)) {\n    if (isPlainObject(value)) {\n      parentReceiver[key] = createMiniState(value, {});\n    } else {\n      defineStateProxy(key, value, parentReceiver);\n    }\n  }\n\n  return parentReceiver as T;\n}\n\nexport function deepMerge<T extends TweenProps>(target: T, source: T) {\n  for (const key in source) {\n    if (\n      source[key] && typeof source[key] === \"object\" &&\n      !Array.isArray(source[key])\n    ) {\n      // istanbul ignore next @preserve\n      if (!target[key]) target[key] = {} as never;\n      deepMerge(target[key] as never, source[key] as never);\n    } else {\n      target[key] = source[key];\n    }\n  }\n}\n\nexport function miniStore<T extends TweenProps>(init: T) {\n  return createMiniState(init, {}) as T;\n}\n","import { Timeline, Tween, type TweenProps } from \"@thednp/tween\";\nimport { onCleanup } from \"solid-js\";\nimport { deepMerge, miniStore } from \"./ministore.ts\";\n\nexport * from \"@thednp/tween\";\n\nexport function createTween<T extends TweenProps>(initialValues: T) {\n  const store = miniStore({ ...initialValues });\n\n  const tween = new Tween(initialValues).onUpdate((newState) => {\n    deepMerge(store, newState);\n  });\n\n  onCleanup(() => {\n    tween.stop();\n  });\n\n  return [store, tween] as [T, Tween<T>];\n}\n\nexport function createTimeline<T extends TweenProps>(initialValues: T) {\n  const store = miniStore({ ...initialValues });\n\n  const timeline = new Timeline(initialValues).onUpdate((newState) => {\n    deepMerge(store, newState);\n  });\n\n  onCleanup(() => {\n    timeline.stop();\n    timeline.clear();\n  });\n\n  return [store, timeline] as [T, Timeline<T>];\n}\n"],"mappings":";;;;AAGA,MAAM,cAAc;AAEpB,MAAM,iBACJ,UAEA,OAAO,UAAU,YACjB,CAAC,MAAM,QAAQ,MAAM,IACrB,OAAO,eAAe,MAAM,KAAK,OAAO;AAE1C,SAAS,iBACP,KACA,OACA,QACA;CACA,MAAM,CAAC,KAAK,kCAAoB,MAAM;AACtC,QAAO,iBAAiB,QAAQ;GAC7B,cAAc;GACb,OAAO;GACP,YAAY;GACZ,cAAc;GACd,UAAU;GACX;GACA,MAAM;GAAE;GAAK;GAAK,YAAY;GAAM;EACtC,CAAC;;AAGJ,SAAS,gBACP,KACA,gBACA;AAEA,KAAI,OAAO,UAAU,eAAe,KAAK,KAAK,YAAY,CAAE,QAAO;AACnE,MAAK,MAAM,CAAC,KAAK,UAAU,OAAO,QAAQ,IAAI,CAC5C,KAAI,cAAc,MAAM,CACtB,gBAAe,OAAO,gBAAgB,OAAO,EAAE,CAAC;KAEhD,kBAAiB,KAAK,OAAO,eAAe;AAIhD,QAAO;;AAGT,SAAgB,UAAgC,QAAW,QAAW;AACpE,MAAK,MAAM,OAAO,OAChB,KACE,OAAO,QAAQ,OAAO,OAAO,SAAS,YACtC,CAAC,MAAM,QAAQ,OAAO,KAAI,EAC1B;AAEA,MAAI,CAAC,OAAO,KAAM,QAAO,OAAO,EAAE;AAClC,YAAU,OAAO,MAAe,OAAO,KAAc;OAErD,QAAO,OAAO,OAAO;;AAK3B,SAAgB,UAAgC,MAAS;AACvD,QAAO,gBAAgB,MAAM,EAAE,CAAC;;;;;ACxDlC,SAAgB,YAAkC,eAAkB;CAClE,MAAM,QAAQ,UAAU,EAAE,GAAG,eAAe,CAAC;CAE7C,MAAM,QAAQ,IAAIA,oBAAM,cAAc,CAAC,UAAU,aAAa;AAC5D,YAAU,OAAO,SAAS;GAC1B;AAEF,+BAAgB;AACd,QAAM,MAAM;GACZ;AAEF,QAAO,CAAC,OAAO,MAAM;;AAGvB,SAAgB,eAAqC,eAAkB;CACrE,MAAM,QAAQ,UAAU,EAAE,GAAG,eAAe,CAAC;CAE7C,MAAM,WAAW,IAAIC,uBAAS,cAAc,CAAC,UAAU,aAAa;AAClE,YAAU,OAAO,SAAS;GAC1B;AAEF,+BAAgB;AACd,WAAS,MAAM;AACf,WAAS,OAAO;GAChB;AAEF,QAAO,CAAC,OAAO,SAAS"}